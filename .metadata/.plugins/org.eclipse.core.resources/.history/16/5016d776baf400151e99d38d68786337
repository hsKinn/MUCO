<?xml version="1.0" encoding="UTF-8"?>
<query>

	<city>
	</city>
	
	<country>
	</country>
	
	<evaluation>
	</evaluation>
	
	<history>
	</history>
	
	<image>
	</image>
	
	<member>
		<addNewMember>
			INSERT INTO MEMBER (
	                      			EMAIL
	                       		 	, PASSWORD
	                       			, NAME
	                   			) 
			VALUES              ( 
	                        		?,
	                        		?,
	                        		?
	                     		)
     	</addNewMember>
     	<getMemberByIdAndPassword>
     		SELECT	*
     		FROM	MEMBER
     		WHERE	EMAIL = ?
     		AND		PASSWORD = ?
     	</getMemberByIdAndPassword>
	</member>
	
	<pack>
	</pack>
	
	<sharePack>
	
		<hitCountPack>
			UPDATE	PACK
			SET		VIEW_COUNT = VIEW_COUNT + 1
			WHERE	PACK_ID = ?
		</hitCountPack>
	
		<getAllPackageCountByHashTag>
			SELECT  COUNT(P.PACK_ID)
			FROM    PACK P
					, HASH_TAG H
			WHERE	P.PACK_ID = H.PACK_ID
			AND		IS_PUBLIC = 1
			AND		HASH_TAG_NAME LIKE '%' || ? || '%'
		</getAllPackageCountByHashTag>

		<getAllPackageListByHashTag>
	         SELECT	*
	         FROM   (
		               SELECT  ROWNUM AS RNUM
		                     , A.*
		               FROM    (
			                     SELECT  DISTINCT P.PACK_ID
			                     		 , PACK_TITLE
			                             , VIEW_COUNT
			                             , (
                                                SELECT  COUNT(PACK_LIKE_ID)
                                                FROM    PACK_LIKE
                                                WHERE   PACK_ID = P.PACK_ID
                                            ) LIKE_COUNT			                             
			                             , M.NAME
			                             , SHARE_IMAGE_LOCATION
			                     FROM    PACK P
			                             , MEMBER M
			                             , HASH_TAG H
			                     WHERE   IS_PUBLIC = 1
			                     AND	 P.PACK_ID = H.PACK_ID
			                     AND	 P.EMAIL = M.EMAIL(+)
			                     AND	 HASH_TAG_NAME LIKE '%' || ? || '%'
			                     ORDER   BY LIKE_COUNT DESC
			                     		 , VIEW_COUNT DESC   
		                     ) A
		               WHERE   ROWNUM &lt;= ?   
	                )
		      WHERE RNUM >= ?      
        </getAllPackageListByHashTag>	

		<getAllPackageListByHashTagOrderByView>
	         SELECT	*
	         FROM   (
		               SELECT  ROWNUM AS RNUM
		                     , A.*
		               FROM    (
			                     SELECT  DISTINCT P.PACK_ID
			                     		 , PACK_TITLE
			                             , VIEW_COUNT
			                             , (
                                                SELECT  COUNT(PACK_LIKE_ID)
                                                FROM    PACK_LIKE
                                                WHERE   PACK_ID = P.PACK_ID
                                            ) LIKE_COUNT			                             
			                             , M.NAME
			                             , SHARE_IMAGE_LOCATION
			                     FROM    PACK P
			                             , MEMBER M
			                             , HASH_TAG H
			                     WHERE   IS_PUBLIC = 1
			                     AND	 P.PACK_ID = H.PACK_ID
			                     AND	 P.EMAIL = M.EMAIL(+)
			                     AND	 HASH_TAG_NAME LIKE '%' || ? || '%'
			                     ORDER   BY LIKE_COUNT DESC
			                     		 , VIEW_COUNT DESC   
		                     ) A
		               WHERE   ROWNUM &lt;= ?   
	                )
		      WHERE RNUM >= ?      
        </getAllPackageListByHashTagOrderByView>	
        	
		<getAllPackageListByHashTagOrderByDate>
	         SELECT	*
	         FROM   (
		               SELECT  ROWNUM AS RNUM
		                     , A.*
		               FROM    (
			                     SELECT  DISTINCT P.PACK_ID
			                     		 , PACK_TITLE
			                             , VIEW_COUNT
			                             , (
                                                SELECT  COUNT(PACK_LIKE_ID)
                                                FROM    PACK_LIKE
                                                WHERE   PACK_ID = P.PACK_ID
                                            ) LIKE_COUNT			                             
			                             , M.NAME
			                             , SHARE_IMAGE_LOCATION
			                     FROM    PACK P
			                             , MEMBER M
			                             , HASH_TAG H
			                     WHERE   IS_PUBLIC = 1
			                     AND	 P.PACK_ID = H.PACK_ID
			                     AND	 P.EMAIL = M.EMAIL(+)
			                     AND	 HASH_TAG_NAME LIKE '%' || ? || '%'
			                     ORDER   BY P.PACK_ID DESC   
		                     ) A
		               WHERE   ROWNUM &lt;= ?   
	                )
		      WHERE RNUM >= ?      
        </getAllPackageListByHashTagOrderByDate>		
        
        <getAllPackageListCount>
			SELECT  COUNT(PACK_ID)
			FROM    PACK
			WHERE	IS_PUBLIC = 1			
        </getAllPackageListCount>
        
        <getAllPackageList>
	         SELECT	*
	         FROM   (
		               SELECT  ROWNUM AS RNUM
		                     , A.*
		               FROM    (
			                     SELECT  P.PACK_ID
			                     		 , PACK_TITLE
			                             , VIEW_COUNT
			                             , (
                                                SELECT  COUNT(PACK_LIKE_ID)
                                                FROM    PACK_LIKE
                                                WHERE   PACK_ID = P.PACK_ID
                                            ) LIKE_COUNT			                             
			                             , M.NAME
			                             , SHARE_IMAGE_LOCATION
			                     FROM    PACK P
			                             , MEMBER M
			                     WHERE   IS_PUBLIC = 1
			                     AND	 P.EMAIL = M.EMAIL(+)
			                     ORDER   BY LIKE_COUNT DESC   
			                     		 , VIEW_COUNT DESC   			                     
		                     ) A
		               WHERE   ROWNUM &lt;= ?   
	                )
		      WHERE RNUM >= ?          
        </getAllPackageList>
        
        <getAllPackageListOrderByDate>
	         SELECT	*
	         FROM   (
		               SELECT  ROWNUM AS RNUM
		                     , A.*
		               FROM    (
			                     SELECT  P.PACK_ID
			                     		 , PACK_TITLE
			                             , VIEW_COUNT
			                             , (
                                                SELECT  COUNT(PACK_LIKE_ID)
                                                FROM    PACK_LIKE
                                                WHERE   PACK_ID = P.PACK_ID
                                            ) LIKE_COUNT			                             
			                             , M.NAME
			                             , SHARE_IMAGE_LOCATION
			                     FROM    PACK P
			                             , MEMBER M
			                     WHERE   IS_PUBLIC = 1
			                     AND	 P.EMAIL = M.EMAIL(+)
			                     ORDER   BY PACK_ID DESC   
		                     ) A
		               WHERE   ROWNUM &lt;= ?   
	                )
		      WHERE RNUM >= ?          
        </getAllPackageListOrderByDate>
        
	</sharePack>
	
	<hashtag>
		
		<getHashTagOfPackage>
			SELECT	HASH_TAG_ID
					, HASH_TAG_NAME
			FROM	HASH_TAG H
					, PACK P
			WHERE	P.PACK_ID = H.PACK_ID
			AND		H.PACK_ID = ?
		</getHashTagOfPackage>
	
	</hashtag>
	
	<packLike>
	
		<selectPackLikeCount>
			SELECT	COUNT(PACK_ID)
			FROM	PACK_LIKE
			WHERE	PACK_ID = ?
			AND		EMAIL = ?
		</selectPackLikeCount>
		
		<insertPackLike>
			INSERT INTO PACK_LIKE	(
									PACK_LIKE_ID
									, PACK_ID
									, EMAIL
								) 
			VALUES 				( 
									PACK_LIKE_ID_SEQ.NEXTVAL
									, ?
									, ?
								)
		</insertPackLike>
		
		<deletePackLike>
			DELETE
			FROM	PACK_LIKE
			WHERE	PACK_ID = ?
			AND		EMAIL = ?
		</deletePackLike>		
		
		<countPackLike>
            SELECT  COUNT(PACK_LIKE_ID)
            FROM    PACK_LIKE
            WHERE   PACK_ID = ?
		</countPackLike>
	
	</packLike>
	
	<packReply>
	</packReply>
	
	<place>
		
		<getPlaceInPackage>
			SELECT	P.PLACE_ID
					, PLACE_NAME
					, ADDRESS
					, LIKE_COUNT
					, COUNTRY_NAME
			FROM	PLACE P
					, PACK_PLACE PACKPLACE
					, COUNTRY C
			WHERE	PACKPLACE.PACK_ID = ?
			AND		PACKPLACE.PLACE_ID = P.PLACE_ID
			AND		P.COUNTRY_ID = C.COUNTRY_ID
		</getPlaceInPackage>
		
	</place>
	
	<placeLike>
	</placeLike>
	
	<placeReply>
	</placeReply>
	
	<qna>
	</qna>
	
	<rent>
	</rent>
	
	<reportedMember>
	</reportedMember>
	
	<reserve>
	</reserve>
	
	<standard>
	</standard>
	
	<stay>
	</stay>
	
	<transport>
	</transport>
	
</query>





