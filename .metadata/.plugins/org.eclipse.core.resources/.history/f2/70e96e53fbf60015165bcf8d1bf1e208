package com.ktds.muco.table.placeReply.biz;

import com.ktds.muco.table.placeReply.dao.PlaceReplyDAO;
import com.ktds.muco.table.placeReply.vo.PlaceReplyVO;

/**
 * 
 * @author 김동규
 *
 */
public class PlaceReplyBiz {

	private PlaceReplyDAO placeReplyDAO;
	
	public PlaceReplyBiz() {
		placeReplyDAO = new PlaceReplyDAO();
	}
	/**
	 * addNewPlaceReplyDepthOne
	 * 
	 * @author 김동규
	 * 
	 * @param placeReply
	 * @return
	 */

	public boolean addNewPlaceReplyDepthOne(PlaceReplyVO placeReply) {
		int orderNo = this.getNewPlaceOrderNo(placeReply);
		placeReply.setOrderNo(orderNo);
		
		if ( orderNo > 0 ) {
			placeReplyDAO.updateOrderNoByGroupId(placeReply);
		}

		return placeReplyDAO.insertPlaceReply(placeReply) > 0;
		
	}
	/**
	 * getNewPlaceOrderNo
	 * 
	 * @author 김동규
	 * 
	 * @param placeReply
	 * @return
	 */
	public int getNewPlaceOrderNo(PlaceReplyVO placeReply) {
		if ( placeReplyDAO.selectCountParentReplyId(placeReply) > 0 ) {
			
			int newOrderNo = placeReplyDAO.selectMaxOrderNoByParentReplyId(placeReply);
			return newOrderNo + 1;
		}
		else {
			
			if ( placeReply.getParentReplyId() != 0 ) {
				int newOrderNo = placeReplyDAO.selectLatestOrderNoByParentReplyId(placeReply);
				return newOrderNo + 1;
			}
		}
			
		return 0;
	}
}
